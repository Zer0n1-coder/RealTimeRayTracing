# 26.5 去噪
使用蒙特卡洛路径追踪算法进行渲染会产生带有不希望出现的噪声图片，如图26.6所示。去噪算法的目的是提取有噪声的图像和选择性辅助图像数据，生成尽可能接近真实情况的新图像。在本节种，我们以非正式的方式使用“相似”一次，因为稍微模糊的图像区域可能比有噪声的图像区域更好。去噪对于实时光线追踪特别重要，因为我们通常只能为每个像素提供少量光线，这意味着渲染图像可能会产生噪声。例如，图26.22中的PICA-PICA图像使用了大约每像素2.25根光线进行的渲染。去噪原理如图26.18所示。由于可以在去噪器中添加反馈回调，如图所示，***temporal antialiasing***可被视为一种基本的去噪算法。大多数（即使不是全部）去噪技术都可以简单地表示为当前像素周围颜色的加权平均值，我们将其枚举为标量值*p*。加权平均值为[公式]，其中dp是像素p的去噪颜色值，cq是当前像素（包括p）周围的噪声颜色值，w(p,q)是加权函数。在这个公式中，在p附近有n个像素，称为N，这个区域通常是正方形。还可以扩展加权函数，以便它使用来自前一帧的信息，例如w(p,p-1,q,q-1)，其中下标-1表示来自该帧的信息。例如，如果需要，加权函数可以访问法线向量nq和先前的颜色值cp-1。去噪示例见图24.2、24.3、26.19、26.20和26.21。
